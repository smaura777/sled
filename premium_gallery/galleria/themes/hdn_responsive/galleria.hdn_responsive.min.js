(function(e){Galleria.addTheme({name:"hdn_responsive",author:"Aki Perez",css:"galleria.hdn_responsive.css",defaults:{transition:"pulse",transitionSpeed:500,imageCrop:true,thumbCrop:true,carousel:false,_locale:{show_thumbnails:"Show thumbnails",hide_thumbnails:"Hide thumbnails",play:"Play slideshow",pause:"Pause slideshow",enter_fullscreen:"Enter fullscreen",exit_fullscreen:"Exit fullscreen",popout_image:"Popout image",showing_image:"Showing image %s of %s"},_showFullscreen:true,_showPopout:true,_showProgress:true,_showTooltip:true},init:function(t){Galleria.requires(1.29,"This version of HDN Responsive theme requires Galleria version 1.2.9 or later");this.addElement("bar","fullscreen","play","popout","thumblink","s1","s2","s3","s4","progress");this.append({stage:"progress",container:["bar","tooltip"],bar:["fullscreen","play","popout","thumblink","info","s1","s2","s3","s4"]});this.prependChild("info","counter");var n=this,r=this.$("thumbnails-container"),i=this.$("thumblink"),s=this.$("fullscreen"),o=this.$("play"),u=this.$("popout"),a=this.$("bar"),f=this.$("progress"),l=t.transition,c=t._locale,h=false,p=false,d=!!t.autoplay,v=false,m=function(){r.height(n.getStageHeight()).width(n.getStageWidth()).css("top",h?0:n.getStageHeight()+30)},g=function(e){if(h&&v){n.play()}else{v=d;n.pause()}Galleria.utils.animate(r,{top:h?n.getStageHeight()+30:0},{easing:"galleria",duration:400,complete:function(){n.defineTooltip("thumblink",h?c.show_thumbnails:c.hide_thumbnails);i[h?"removeClass":"addClass"]("open");h=!h}})};m();if(t._showTooltip){n.bindTooltip({thumblink:c.show_thumbnails,fullscreen:c.enter_fullscreen,play:function(){return d?c.pause:c.play},popout:c.popout_image,caption:function(){var e=n.getData();var t="";if(e){if(e.title&&e.title.length){t+="<strong>"+e.title+"</strong>"}if(e.description&&e.description.length){t+="<br>"+e.description}}return t},counter:function(){return c.showing_image.replace(/\%s/,n.getIndex()+1).replace(/\%s/,n.getDataLength())}})}if(!t.showInfo){this.$("info").hide()}this.bind("play",function(){d=true;o.addClass("playing")});this.bind("pause",function(){d=false;o.removeClass("playing");f.width(0)});if(t._showProgress){this.bind("progress",function(e){f.width(e.percent/100*this.getStageWidth())})}this.bind("loadstart",function(e){if(!e.cached){this.$("loader").show()}});this.bind("loadfinish",function(e){f.width(0);this.$("loader").hide();this.refreshTooltip("counter","caption")});this.bind("thumbnail",function(t){e(t.thumbTarget).hover(function(){n.setInfo(t.thumbOrder);n.setCounter(t.thumbOrder)},function(){n.setInfo();n.setCounter()}).click(function(){g()})});this.bind("fullscreen_enter",function(e){p=true;n.setOptions("transition",false);s.addClass("open");a.css("bottom",0);this.defineTooltip("fullscreen",c.exit_fullscreen);if(!Galleria.TOUCH){this.addIdleState(a,{bottom:-31})}});this.bind("fullscreen_exit",function(e){p=false;Galleria.utils.clearTimer("bar");n.setOptions("transition",l);s.removeClass("open");a.css("bottom",0);this.defineTooltip("fullscreen",c.enter_fullscreen);if(!Galleria.TOUCH){this.removeIdleState(a,{bottom:-31})}});this.bind("rescale",m);if(!Galleria.TOUCH){this.addIdleState(this.get("image-nav-left"),{left:-36});this.addIdleState(this.get("image-nav-right"),{right:-36})}i.click(g);if(!t.thumbnails){i.hide();o.css("left",0);this.$("s2").hide();this.$("info").css("left",41)}if(t._showPopout){u.click(function(e){n.openLightbox();e.preventDefault()})}else{u.remove();if(t._showFullscreen){this.$("s4").remove();this.$("info").css("right",40);s.css("right",0)}}o.click(function(){if(d){n.pause()}else{if(h){i.click()}n.play()}});if(t._showFullscreen){s.click(function(){if(p){n.exitFullscreen()}else{n.enterFullscreen()}})}else{s.remove();if(t._show_popout){this.$("s4").remove();this.$("info").css("right",40);u.css("right",0)}}if(!t._showFullscreen&&!t._showPopout){this.$("s3,s4").remove();this.$("info").css("right",10)}if(t.autoplay){this.trigger("play")}}})})(jQuery)